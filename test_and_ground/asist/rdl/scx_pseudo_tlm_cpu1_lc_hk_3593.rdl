!==============================================================================
!
!                Originator: W. Moleski
!                Responsible SC:
!                Responsible CSE:
!                Rev:  Last Change: Feb 02 2012
!
!                    Telemetry Packet # 3593 (dec)
!                 =================================
!
!       Packet Application ID: 3593 (Hex '0E09')
!       Packet Title:  SCX CPU1 LC Pseudo HK Telemetry Data Packet
!
!       REFERENCES:
!
!       NOTES:
!
!       HISTORY:
!       2012/02/02  WFM      : Initial with Packet E09 and APID 3593
!       2012/08/08  WFM      : Replaced Not Measured with Stale
!==============================================================================

PACKET P0E09 APID=3593, DESC="SCX CPU1 LC Pseudo HK Telemetry Packet"

#include "ccsds_header.rdl"
#include "lc_platform_cfg.h"

UB SCX_CPU1_LC_WPResult[0 .. LC_MAX_WATCHPOINTS - 1] mask=%x03,DESC="WP Results",
                             DISCRETE, DRANGE=(0,1,2,3),DLABEL=("False","True","Error","Stale")

UB SCX_CPU1_LC_APResult[0 .. LC_MAX_ACTIONPOINTS - 1] mask=%x03,DESC="AP Results",
                             DISCRETE,DRANGE=(0,1,2,3),DLABEL=("Pass","Fail","Error","Stale")

UB SCX_CPU1_LC_APState[0 .. LC_MAX_ACTIONPOINTS - 1]  mask=%x03,DESC="AP State",
                             DISCRETE,DRANGE=(0,1,2,3),DLABEL=("Not Used","Active","Passive","Disabled")

UI SCX_CPU1_PSEUDO_LC_TLM
   DESC="SCX CPU1 Limit Checker Pseudo Telemetry",
   EQUATION = WHEN PKT_RCVD = 0167
   DO
     FOR i = 1 TO LC_MAX_WATCHPOINTS/4 DO
        SCX_CPU1_LC_WPResult[i*4 - 1] = SCX_CPU1_LC_WRResults[i].WPByteEntry.WP3Result
        SCX_CPU1_LC_WPResult[i*4 - 2] = SCX_CPU1_LC_WRResults[i].WPByteEntry.WP2Result
        SCX_CPU1_LC_WPResult[i*4 - 3] = SCX_CPU1_LC_WRResults[i].WPByteEntry.WP1Result
        SCX_CPU1_LC_WPResult[i*4 - 4] = SCX_CPU1_LC_WRResults[i].WPByteEntry.WP0Result
     ENDDO

     FOR i = 1 TO LC_MAX_ACTIONPOINTS/2 DO
        SCX_CPU1_LC_APState[i*2 - 1] =  SCX_CPU1_LC_ARResults[i].APByteEntry.AP1State
        SCX_CPU1_LC_APResult[i*2 - 1] = SCX_CPU1_LC_ARResults[i].APByteEntry.AP1Result

        SCX_CPU1_LC_APState[i*2 - 2] = SCX_CPU1_LC_ARResults[i].APByteEntry.AP0State
        SCX_CPU1_LC_APResult[i*2 - 2] = SCX_CPU1_LC_ARResults[i].APByteEntry.AP0Result
     ENDDO
   ENDDO

END ! PACKET P0EA7
